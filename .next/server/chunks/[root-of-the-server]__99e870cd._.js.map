{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var __prisma: PrismaClient | undefined;\n}\n\nfunction createPrismaClient() {\n  const client = new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"error\", \"warn\"] : [\"error\"],\n  });\n\n  return client;\n}\n\nexport const prisma = globalThis.__prisma ?? createPrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalThis.__prisma = prisma;\n}\n"],"names":[],"mappings":";;;AAAA;;AAOA,SAAS;IACP,MAAM,SAAS,IAAI,6HAAA,CAAA,eAAY,CAAC;QAC9B,KAAK,uCAAyC;YAAC;YAAS;SAAO,GAAG;IACpE;IAEA,OAAO;AACT;AAEO,MAAM,SAAS,WAAW,QAAQ,IAAI;AAE7C,wCAA2C;IACzC,WAAW,QAAQ,GAAG;AACxB","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/api/auth/forgot-password/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport crypto from \"crypto\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport const runtime = \"nodejs\";\n\nexport async function POST(req: NextRequest) {\n  console.log(\"üöÄ /api/auth/forgot-password HIT\");\n\n  try {\n    const body = await req.json().catch(() => null);\n    const email = (body?.email || \"\").toString().trim().toLowerCase();\n\n    if (!email) {\n      return NextResponse.json(\n        { success: false, error: \"Email √© obrigat√≥rio.\" },\n        { status: 400 }\n      );\n    }\n\n    const user = await prisma.user.findUnique({ where: { email } });\n\n    // ‚ö†Ô∏è Seguran√ßa: n√£o revelar se existe ou n√£o\n    if (!user) {\n      return NextResponse.json({ success: true });\n    }\n\n    // remove tokens antigos\n    await prisma.passwordResetToken.deleteMany({\n      where: { userId: user.id },\n    });\n\n    // gera token\n    const token = crypto.randomBytes(32).toString(\"hex\");\n    const expiresAt = new Date(Date.now() + 1000 * 60 * 60); // 1h\n\n    await prisma.passwordResetToken.create({\n      data: {\n        userId: user.id,\n        token,\n        expiresAt,\n      },\n    });\n\n    // monta link (funciona mesmo sem NEXT_PUBLIC_APP_URL)\n    const origin =\n      process.env.NEXT_PUBLIC_APP_URL?.trim() ||\n      req.nextUrl.origin ||\n      \"http://localhost:3000\";\n\n    const resetLink = `${origin}/reset-password?token=${token}`;\n\n    console.log(\"üîê RESET PASSWORD LINK:\");\n    console.log(resetLink);\n\n    // ‚úÖ futuramente: enviar email aqui (Resend/Sendgrid/Mailgun)\n    return NextResponse.json({ success: true });\n  } catch (err) {\n    console.error(\"FORGOT_PASSWORD_ERROR:\", err);\n    return NextResponse.json(\n      { success: false, error: \"Erro ao processar solicita√ß√£o.\" },\n      { status: 500 }\n    );\n  }\n}\n\n// (Opcional) Se algu√©m acessar via GET no browser, retorna 405 bonitinho\nexport async function GET() {\n  return NextResponse.json(\n    { success: false, error: \"M√©todo n√£o permitido.\" },\n    { status: 405 }\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;AAEO,MAAM,UAAU;AAEhB,eAAe,KAAK,GAAgB;IACzC,QAAQ,GAAG,CAAC;IAEZ,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;QAC1C,MAAM,QAAQ,CAAC,MAAM,SAAS,EAAE,EAAE,QAAQ,GAAG,IAAI,GAAG,WAAW;QAE/D,IAAI,CAAC,OAAO;YACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAuB,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,sHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAE7D,6CAA6C;QAC7C,IAAI,CAAC,MAAM;YACT,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAK;QAC3C;QAEA,wBAAwB;QACxB,MAAM,sHAAA,CAAA,SAAM,CAAC,kBAAkB,CAAC,UAAU,CAAC;YACzC,OAAO;gBAAE,QAAQ,KAAK,EAAE;YAAC;QAC3B;QAEA,aAAa;QACb,MAAM,QAAQ,qGAAA,CAAA,UAAM,CAAC,WAAW,CAAC,IAAI,QAAQ,CAAC;QAC9C,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,OAAO,KAAK,KAAK,KAAK;QAE9D,MAAM,sHAAA,CAAA,SAAM,CAAC,kBAAkB,CAAC,MAAM,CAAC;YACrC,MAAM;gBACJ,QAAQ,KAAK,EAAE;gBACf;gBACA;YACF;QACF;QAEA,sDAAsD;QACtD,MAAM,SACJ,2DAAiC,UACjC,IAAI,OAAO,CAAC,MAAM,IAClB;QAEF,MAAM,YAAY,GAAG,OAAO,sBAAsB,EAAE,OAAO;QAE3D,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC;QAEZ,6DAA6D;QAC7D,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAAiC,GAC1D;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe;IACpB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;QAAE,SAAS;QAAO,OAAO;IAAwB,GACjD;QAAE,QAAQ;IAAI;AAElB","debugId":null}}]
}