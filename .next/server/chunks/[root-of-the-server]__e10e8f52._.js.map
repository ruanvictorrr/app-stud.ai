{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var __prisma: PrismaClient | undefined;\n}\n\nfunction createPrismaClient() {\n  const client = new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"error\", \"warn\"] : [\"error\"],\n  });\n\n  return client;\n}\n\nexport const prisma = globalThis.__prisma ?? createPrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalThis.__prisma = prisma;\n}\n"],"names":[],"mappings":";;;AAAA;;AAOA,SAAS;IACP,MAAM,SAAS,IAAI,6HAAA,CAAA,eAAY,CAAC;QAC9B,KAAK,uCAAyC;YAAC;YAAS;SAAO,GAAG;IACpE;IAEA,OAAO;AACT;AAEO,MAAM,SAAS,WAAW,QAAQ,IAAI;AAE7C,wCAA2C;IACzC,WAAW,QAAQ,GAAG;AACxB","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\nimport bcrypt from \"bcryptjs\";\nimport crypto from \"crypto\";\n\nexport const runtime = \"nodejs\";\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json();\n    const email = body.email?.toLowerCase().trim();\n    const password = body.password;\n\n    if (!email || !password) {\n      return NextResponse.json(\n        { success: false, error: \"Email e senha sÃ£o obrigatÃ³rios.\" },\n        { status: 400 }\n      );\n    }\n\n    const user = await prisma.user.findUnique({ where: { email } });\n\n    if (!user || !user.passwordHash) {\n      return NextResponse.json(\n        { success: false, error: \"Credenciais invÃ¡lidas.\" },\n        { status: 401 }\n      );\n    }\n\n    const valid = await bcrypt.compare(password, user.passwordHash);\n    if (!valid) {\n      return NextResponse.json(\n        { success: false, error: \"Credenciais invÃ¡lidas.\" },\n        { status: 401 }\n      );\n    }\n\n    // cria token de sessÃ£o\n    const sessionToken = crypto.randomBytes(32).toString(\"hex\");\n\n    await prisma.session.create({\n      data: {\n        sessionToken,\n        userId: user.id,\n        expires: new Date(Date.now() + 1000 * 60 * 60 * 24 * 30), // 30 dias\n      },\n    });\n\n    const res = NextResponse.json({\n      success: true,\n      user: {\n        id: user.id,\n        email: user.email,\n        role: user.role,\n        name: user.name,\n      },\n    });\n\n    // ðŸ”¥ ESSENCIAL PARA SAFARI\n    res.cookies.set(\"studai_session\", sessionToken, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\", // ðŸ‘ˆ OBRIGATÃ“RIO\n      path: \"/\",\n      maxAge: 60 * 60 * 24 * 30,\n    });\n\n    return res;\n  } catch (err) {\n    console.error(\"LOGIN_ERROR:\", err);\n    return NextResponse.json(\n      { success: false, error: \"Erro ao fazer login.\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,MAAM,UAAU;AAEhB,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,QAAQ,KAAK,KAAK,EAAE,cAAc;QACxC,MAAM,WAAW,KAAK,QAAQ;QAE9B,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAkC,GAC3D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,sHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAE7D,IAAI,CAAC,QAAQ,CAAC,KAAK,YAAY,EAAE;YAC/B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAyB,GAClD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,MAAM,mIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU,KAAK,YAAY;QAC9D,IAAI,CAAC,OAAO;YACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAyB,GAClD;gBAAE,QAAQ;YAAI;QAElB;QAEA,uBAAuB;QACvB,MAAM,eAAe,qGAAA,CAAA,UAAM,CAAC,WAAW,CAAC,IAAI,QAAQ,CAAC;QAErD,MAAM,sHAAA,CAAA,SAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YAC1B,MAAM;gBACJ;gBACA,QAAQ,KAAK,EAAE;gBACf,SAAS,IAAI,KAAK,KAAK,GAAG,KAAK,OAAO,KAAK,KAAK,KAAK;YACvD;QACF;QAEA,MAAM,MAAM,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAC5B,SAAS;YACT,MAAM;gBACJ,IAAI,KAAK,EAAE;gBACX,OAAO,KAAK,KAAK;gBACjB,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;YACjB;QACF;QAEA,2BAA2B;QAC3B,IAAI,OAAO,CAAC,GAAG,CAAC,kBAAkB,cAAc;YAC9C,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,MAAM;YACN,QAAQ,KAAK,KAAK,KAAK;QACzB;QAEA,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAAuB,GAChD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}