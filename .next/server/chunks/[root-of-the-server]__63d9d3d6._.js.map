{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var __prisma: PrismaClient | undefined;\n}\n\nfunction createPrismaClient() {\n  const client = new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"error\", \"warn\"] : [\"error\"],\n  });\n\n  return client;\n}\n\nexport const prisma = globalThis.__prisma ?? createPrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalThis.__prisma = prisma;\n}\n"],"names":[],"mappings":";;;AAAA;;AAOA,SAAS;IACP,MAAM,SAAS,IAAI,6HAAA,CAAA,eAAY,CAAC;QAC9B,KAAK,uCAAyC;YAAC;YAAS;SAAO,GAAG;IACpE;IAEA,OAAO;AACT;AAEO,MAAM,SAAS,WAAW,QAAQ,IAAI;AAE7C,wCAA2C;IACzC,WAAW,QAAQ,GAAG;AACxB","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/api/auth/forgot/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\nimport { randomBytes } from \"crypto\";\n\nexport const runtime = \"nodejs\";\nexport const dynamic = \"force-dynamic\";\n\nfunction normalizeEmail(v: any) {\n  return (v || \"\").toString().trim().toLowerCase();\n}\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json().catch(() => null);\n    const email = normalizeEmail(body?.email);\n\n    if (!email) {\n      return NextResponse.json(\n        { success: false, error: \"Informe seu email.\" },\n        { status: 400 }\n      );\n    }\n\n    // Não revela se existe ou não (boa prática)\n    const user = await prisma.user.findUnique({ where: { email } });\n\n    if (!user) {\n      return NextResponse.json({ success: true }, { status: 200 });\n    }\n\n    const token = randomBytes(32).toString(\"hex\");\n    const expires = new Date(Date.now() + 1000 * 60 * 30); // 30 min\n\n    // apaga tokens antigos desse email (limpeza)\n    await prisma.verificationToken.deleteMany({\n      where: { identifier: email },\n    });\n\n    await prisma.verificationToken.create({\n      data: {\n        identifier: email,\n        token,\n        expires,\n      },\n    });\n\n    // ✅ link de teste (mostra no terminal)\n    const origin =\n      req.headers.get(\"origin\") ||\n      req.headers.get(\"x-forwarded-host\") ||\n      \"http://localhost:3000\";\n\n    const base = origin.startsWith(\"http\") ? origin : `http://${origin}`;\n    const link = `${base}/reset-password?token=${token}&email=${encodeURIComponent(email)}`;\n\n    console.log(\"\\n[RESET PASSWORD LINK]\\n\", link, \"\\n\");\n\n    return NextResponse.json({ success: true }, { status: 200 });\n  } catch (err: any) {\n    console.error(\"FORGOT_ERROR:\", err);\n    return NextResponse.json(\n      { success: false, error: \"Erro ao solicitar redefinição.\", details: err?.message || String(err) },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;AAEO,MAAM,UAAU;AAChB,MAAM,UAAU;AAEvB,SAAS,eAAe,CAAM;IAC5B,OAAO,CAAC,KAAK,EAAE,EAAE,QAAQ,GAAG,IAAI,GAAG,WAAW;AAChD;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;QAC1C,MAAM,QAAQ,eAAe,MAAM;QAEnC,IAAI,CAAC,OAAO;YACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAqB,GAC9C;gBAAE,QAAQ;YAAI;QAElB;QAEA,4CAA4C;QAC5C,MAAM,OAAO,MAAM,sHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAE7D,IAAI,CAAC,MAAM;YACT,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAK,GAAG;gBAAE,QAAQ;YAAI;QAC5D;QAEA,MAAM,QAAQ,CAAA,GAAA,qGAAA,CAAA,cAAW,AAAD,EAAE,IAAI,QAAQ,CAAC;QACvC,MAAM,UAAU,IAAI,KAAK,KAAK,GAAG,KAAK,OAAO,KAAK,KAAK,SAAS;QAEhE,6CAA6C;QAC7C,MAAM,sHAAA,CAAA,SAAM,CAAC,iBAAiB,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE,YAAY;YAAM;QAC7B;QAEA,MAAM,sHAAA,CAAA,SAAM,CAAC,iBAAiB,CAAC,MAAM,CAAC;YACpC,MAAM;gBACJ,YAAY;gBACZ;gBACA;YACF;QACF;QAEA,uCAAuC;QACvC,MAAM,SACJ,IAAI,OAAO,CAAC,GAAG,CAAC,aAChB,IAAI,OAAO,CAAC,GAAG,CAAC,uBAChB;QAEF,MAAM,OAAO,OAAO,UAAU,CAAC,UAAU,SAAS,CAAC,OAAO,EAAE,QAAQ;QACpE,MAAM,OAAO,GAAG,KAAK,sBAAsB,EAAE,MAAM,OAAO,EAAE,mBAAmB,QAAQ;QAEvF,QAAQ,GAAG,CAAC,6BAA6B,MAAM;QAE/C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK,GAAG;YAAE,QAAQ;QAAI;IAC5D,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;YAAkC,SAAS,KAAK,WAAW,OAAO;QAAK,GAChG;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}