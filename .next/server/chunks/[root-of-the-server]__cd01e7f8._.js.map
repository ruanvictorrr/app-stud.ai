{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var __prisma: PrismaClient | undefined;\n}\n\nfunction createPrismaClient() {\n  const client = new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"error\", \"warn\"] : [\"error\"],\n  });\n\n  return client;\n}\n\nexport const prisma = globalThis.__prisma ?? createPrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalThis.__prisma = prisma;\n}\n"],"names":[],"mappings":";;;AAAA;;AAOA,SAAS;IACP,MAAM,SAAS,IAAI,6HAAA,CAAA,eAAY,CAAC;QAC9B,KAAK,uCAAyC;YAAC;YAAS;SAAO,GAAG;IACpE;IAEA,OAAO;AACT;AAEO,MAAM,SAAS,WAAW,QAAQ,IAAI;AAE7C,wCAA2C;IACzC,WAAW,QAAQ,GAAG;AACxB","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/api/auth/reset-password/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport bcrypt from \"bcryptjs\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport const runtime = \"nodejs\";\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json().catch(() => null);\n    const token = body?.token;\n    const password = body?.password;\n\n    if (!token || !password) {\n      return NextResponse.json(\n        { success: false, error: \"Token e senha são obrigatórios.\" },\n        { status: 400 }\n      );\n    }\n\n    // 1️⃣ Busca token\n    const resetToken = await prisma.passwordResetToken.findUnique({\n      where: { token },\n      include: { user: true },\n    });\n\n    if (!resetToken) {\n      return NextResponse.json(\n        { success: false, error: \"Token inválido.\" },\n        { status: 400 }\n      );\n    }\n\n    // 2️⃣ Verifica expiração\n    if (resetToken.expiresAt < new Date()) {\n      await prisma.passwordResetToken.delete({ where: { token } });\n\n      return NextResponse.json(\n        { success: false, error: \"Token expirado.\" },\n        { status: 400 }\n      );\n    }\n\n    // 3️⃣ Criptografa nova senha\n    const passwordHash = await bcrypt.hash(password, 10);\n\n    // 4️⃣ Atualiza usuário\n    await prisma.user.update({\n      where: { id: resetToken.userId },\n      data: { passwordHash },\n    });\n\n    // 5️⃣ Remove token (uso único)\n    await prisma.passwordResetToken.delete({\n      where: { token },\n    });\n\n    return NextResponse.json({ success: true });\n  } catch (err) {\n    console.error(\"RESET_PASSWORD_ERROR:\", err);\n    return NextResponse.json(\n      { success: false, error: \"Erro ao redefinir senha.\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,MAAM,UAAU;AAEhB,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;QAC1C,MAAM,QAAQ,MAAM;QACpB,MAAM,WAAW,MAAM;QAEvB,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAkC,GAC3D;gBAAE,QAAQ;YAAI;QAElB;QAEA,kBAAkB;QAClB,MAAM,aAAa,MAAM,sHAAA,CAAA,SAAM,CAAC,kBAAkB,CAAC,UAAU,CAAC;YAC5D,OAAO;gBAAE;YAAM;YACf,SAAS;gBAAE,MAAM;YAAK;QACxB;QAEA,IAAI,CAAC,YAAY;YACf,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAkB,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,yBAAyB;QACzB,IAAI,WAAW,SAAS,GAAG,IAAI,QAAQ;YACrC,MAAM,sHAAA,CAAA,SAAM,CAAC,kBAAkB,CAAC,MAAM,CAAC;gBAAE,OAAO;oBAAE;gBAAM;YAAE;YAE1D,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAkB,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,6BAA6B;QAC7B,MAAM,eAAe,MAAM,mIAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU;QAEjD,uBAAuB;QACvB,MAAM,sHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACvB,OAAO;gBAAE,IAAI,WAAW,MAAM;YAAC;YAC/B,MAAM;gBAAE;YAAa;QACvB;QAEA,+BAA+B;QAC/B,MAAM,sHAAA,CAAA,SAAM,CAAC,kBAAkB,CAAC,MAAM,CAAC;YACrC,OAAO;gBAAE;YAAM;QACjB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAA2B,GACpD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}