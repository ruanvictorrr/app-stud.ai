{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/lib/studyMaterialStore.ts"],"sourcesContent":["// src/lib/studyMaterialStore.ts\nexport type Flashcard = {\n  id: number;\n  question: string;\n  answer: string;\n};\n\nexport type SummaryTopic = {\n  id: number;\n  title: string;\n  content: string;\n  icon: string;\n};\n\nexport type StudySummary = {\n  title: string;\n  mainTopics: SummaryTopic[];\n  keyPoints: string[];\n};\n\nexport type StudyMaterial = {\n  topic: string;\n  flashcards: Flashcard[];\n  summary: StudySummary;\n  // opcionais (se você quiser usar depois)\n  materialId?: string;\n  createdAt?: string;\n};\n\nconst STORAGE_KEY = \"studai:lastMaterial:v1\";\nconst EVENT_NAME = \"studai:material_updated\";\n\nexport function normalizeFromApi(payload: any): StudyMaterial | null {\n  // aceita:\n  // - { success:true, data:{...} }\n  // - { topic, flashcards, summary }\n  const data = payload?.data ?? payload;\n\n  const topic = data?.topic;\n  const flashcards = data?.flashcards;\n  const summary = data?.summary;\n\n  if (!topic || !Array.isArray(flashcards) || !summary) return null;\n\n  if (\n    typeof summary?.title !== \"string\" ||\n    !Array.isArray(summary?.mainTopics) ||\n    !Array.isArray(summary?.keyPoints)\n  ) {\n    return null;\n  }\n\n  return {\n    topic,\n    flashcards,\n    summary,\n    materialId: payload?.meta?.materialId ?? payload?.materialId ?? data?.materialId,\n    createdAt: new Date().toISOString(),\n  };\n}\n\nexport function saveMaterial(material: StudyMaterial) {\n  if (typeof window === \"undefined\") return;\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(material));\n  window.dispatchEvent(new Event(EVENT_NAME));\n}\n\nexport function loadMaterial(): StudyMaterial | null {\n  if (typeof window === \"undefined\") return null;\n  const raw = localStorage.getItem(STORAGE_KEY);\n  if (!raw) return null;\n\n  try {\n    return JSON.parse(raw) as StudyMaterial;\n  } catch {\n    return null;\n  }\n}\n\nexport function clearMaterial() {\n  if (typeof window === \"undefined\") return;\n  localStorage.removeItem(STORAGE_KEY);\n  window.dispatchEvent(new Event(EVENT_NAME));\n}\n\nexport function onMaterialUpdated(cb: () => void) {\n  if (typeof window === \"undefined\") return () => {};\n\n  const handler = () => cb();\n  window.addEventListener(EVENT_NAME, handler);\n\n  // também reage quando outro tab atualiza\n  const storageHandler = (e: StorageEvent) => {\n    if (e.key === STORAGE_KEY) cb();\n  };\n  window.addEventListener(\"storage\", storageHandler);\n\n  return () => {\n    window.removeEventListener(EVENT_NAME, handler);\n    window.removeEventListener(\"storage\", storageHandler);\n  };\n}\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;AA6BhC,MAAM,cAAc;AACpB,MAAM,aAAa;AAEZ,SAAS,iBAAiB,OAAY;QAwB7B;QApBD;IAHb,UAAU;IACV,iCAAiC;IACjC,mCAAmC;IACnC,MAAM,OAAO,CAAA,gBAAA,oBAAA,8BAAA,QAAS,IAAI,cAAb,2BAAA,gBAAiB;IAE9B,MAAM,QAAQ,iBAAA,2BAAA,KAAM,KAAK;IACzB,MAAM,aAAa,iBAAA,2BAAA,KAAM,UAAU;IACnC,MAAM,UAAU,iBAAA,2BAAA,KAAM,OAAO;IAE7B,IAAI,CAAC,SAAS,CAAC,MAAM,OAAO,CAAC,eAAe,CAAC,SAAS,OAAO;IAE7D,IACE,QAAO,oBAAA,8BAAA,QAAS,KAAK,MAAK,YAC1B,CAAC,MAAM,OAAO,CAAC,oBAAA,8BAAA,QAAS,UAAU,KAClC,CAAC,MAAM,OAAO,CAAC,oBAAA,8BAAA,QAAS,SAAS,GACjC;QACA,OAAO;IACT;QAMc,0BAAA;IAJd,OAAO;QACL;QACA;QACA;QACA,YAAY,CAAA,OAAA,CAAA,2BAAA,oBAAA,+BAAA,gBAAA,QAAS,IAAI,cAAb,oCAAA,cAAe,UAAU,cAAzB,sCAAA,2BAA6B,oBAAA,8BAAA,QAAS,UAAU,cAAhD,kBAAA,OAAoD,iBAAA,2BAAA,KAAM,UAAU;QAChF,WAAW,IAAI,OAAO,WAAW;IACnC;AACF;AAEO,SAAS,aAAa,QAAuB;IAClD;;IACA,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;IACjD,OAAO,aAAa,CAAC,IAAI,MAAM;AACjC;AAEO,SAAS;IACd;;IACA,MAAM,MAAM,aAAa,OAAO,CAAC;IACjC,IAAI,CAAC,KAAK,OAAO;IAEjB,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,UAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS;IACd;;IACA,aAAa,UAAU,CAAC;IACxB,OAAO,aAAa,CAAC,IAAI,MAAM;AACjC;AAEO,SAAS,kBAAkB,EAAc;IAC9C;;IAEA,MAAM,UAAU,IAAM;IACtB,OAAO,gBAAgB,CAAC,YAAY;IAEpC,yCAAyC;IACzC,MAAM,iBAAiB,CAAC;QACtB,IAAI,EAAE,GAAG,KAAK,aAAa;IAC7B;IACA,OAAO,gBAAgB,CAAC,WAAW;IAEnC,OAAO;QACL,OAAO,mBAAmB,CAAC,YAAY;QACvC,OAAO,mBAAmB,CAAC,WAAW;IACxC;AACF","debugId":null}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/components/UploadSection.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { Upload, Sparkles, RotateCcw, BookOpen, FileText } from \"lucide-react\";\nimport { loadMaterial, saveMaterial } from \"@/lib/studyMaterialStore\";\n\ntype SummaryStyle = \"bullet\" | \"explained\";\ntype Difficulty = \"easy\" | \"medium\" | \"hard\";\n\nfunction cn(...s: Array<string | false | null | undefined>) {\n  return s.filter(Boolean).join(\" \");\n}\n\nexport default function UploadSection({\n  onDataProcessed,\n  onGoFlashcards,\n  onGoSummary,\n}: {\n  onDataProcessed?: (data: any) => void;\n  onGoFlashcards?: () => void;\n  onGoSummary?: () => void;\n}) {\n  const inputRef = useRef<HTMLInputElement | null>(null);\n\n  const [file, setFile] = useState<File | null>(null);\n  const [fileLabel, setFileLabel] = useState<string>(\"\");\n\n  const [summaryStyle, setSummaryStyle] = useState<SummaryStyle>(\"bullet\");\n  const [difficulty, setDifficulty] = useState<Difficulty>(\"medium\");\n  const [flashcardsCount, setFlashcardsCount] = useState<number>(10);\n\n  const [isUploading, setIsUploading] = useState(false);\n  const [success, setSuccess] = useState(false);\n\n  const [error, setError] = useState<string | null>(null);\n  const [apiRemaining, setApiRemaining] = useState<number | null>(null);\n  const [provider, setProvider] = useState<string | null>(null);\n\n  // carrega último material salvo (não some ao trocar de seção/página)\n  useEffect(() => {\n    const last = loadMaterial();\n    if (last) {\n      setSuccess(true);\n      onDataProcessed?.(last);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const canGenerate = useMemo(() => !!file && !isUploading, [file, isUploading]);\n\n  function onPickFile() {\n    inputRef.current?.click();\n  }\n\n  async function handleUpload(selectedFile: File) {\n    setError(null);\n    setIsUploading(true);\n    setSuccess(false);\n\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", selectedFile);\n\n      // ✅ opções do usuário\n      formData.append(\"summaryStyle\", summaryStyle);\n      formData.append(\"difficulty\", difficulty);\n      formData.append(\"flashcardsCount\", String(flashcardsCount));\n\n      const response = await fetch(\"/api/process-study-material\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      const json = await response.json().catch(() => null);\n\n      if (!response.ok || !json?.success) {\n        // erros “bons” do backend\n        const msg =\n          json?.error ||\n          json?.details ||\n          (response.status === 402\n            ? \"Você atingiu o limite do plano grátis.\"\n            : response.status === 401\n            ? \"Você precisa estar logado para gerar.\"\n            : response.status === 503\n            ? \"Modelo sobrecarregado. Tente novamente.\"\n            : \"Falha ao processar arquivo.\");\n\n        throw new Error(msg);\n      }\n\n      setProvider(json?.provider || null);\n      setApiRemaining(typeof json?.remaining === \"number\" ? json.remaining : null);\n\n      // backend retorna { success:true, data:{...} }\n      const material = json?.data;\n\n      if (!material?.topic || !material?.flashcards || !material?.summary) {\n        throw new Error(\"Resposta inválida: faltou topic/flashcards/summary.\");\n      }\n\n      // ✅ persiste para não sumir ao mudar de página/seção\n      saveMaterial(material);\n      onDataProcessed?.(material);\n\n      setSuccess(true);\n    } catch (e: any) {\n      setSuccess(false);\n      setError(e?.message || \"Erro inesperado\");\n    } finally {\n      setIsUploading(false);\n    }\n  }\n\n  async function onFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const f = e.target.files?.[0];\n    if (!f) return;\n\n    setFile(f);\n    setFileLabel(`${f.name} • ${(f.size / 1024 / 1024).toFixed(2)} MB`);\n\n    await handleUpload(f);\n\n    // limpa input para permitir escolher o mesmo arquivo novamente\n    e.target.value = \"\";\n  }\n\n  async function onDrop(e: React.DragEvent<HTMLDivElement>) {\n    e.preventDefault();\n    const f = e.dataTransfer.files?.[0];\n    if (!f) return;\n\n    setFile(f);\n    setFileLabel(`${f.name} • ${(f.size / 1024 / 1024).toFixed(2)} MB`);\n\n    await handleUpload(f);\n  }\n\n  function onDragOver(e: React.DragEvent<HTMLDivElement>) {\n    e.preventDefault();\n  }\n\n  async function onGenerateAgain() {\n    if (!file) {\n      setError(\"Selecione um arquivo novamente para gerar.\");\n      return;\n    }\n    await handleUpload(file);\n  }\n\n  return (\n    <section className=\"w-full\">\n      {/* input */}\n      <input\n        ref={inputRef}\n        type=\"file\"\n        className=\"hidden\"\n        onChange={onFileChange}\n        accept=\"image/*,application/pdf,text/plain\"\n      />\n\n      {/* card */}\n      <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0F0F0F] p-6 sm:p-8\">\n        <div className=\"flex items-start justify-between gap-4\">\n          <div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"h-9 w-9 rounded-xl bg-[#00FF8B]/10 flex items-center justify-center border border-[#00FF8B]/20\">\n                <Upload className=\"h-5 w-5 text-[#00FF8B]\" />\n              </div>\n              <h2 className=\"text-lg sm:text-xl font-semibold\">Upload do material</h2>\n            </div>\n            <p className=\"mt-2 text-sm text-gray-400\">\n              Envie uma imagem, PDF ou texto para gerar flashcards e resumo automaticamente.\n            </p>\n          </div>\n\n          {provider ? (\n            <div className=\"hidden sm:flex items-center gap-2 text-xs px-3 py-2 rounded-full border border-[#1A1A1A] text-gray-400\">\n              <Sparkles className=\"h-4 w-4 text-[#00FF8B]\" />\n              <span>IA: {provider}</span>\n              {typeof apiRemaining === \"number\" ? (\n                <span className=\"text-gray-500\">• restante: {apiRemaining}</span>\n              ) : null}\n            </div>\n          ) : null}\n        </div>\n\n        {/* opções */}\n        <div className=\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div className=\"rounded-xl border border-[#1A1A1A] bg-[#0D0D0D] p-4\">\n            <div className=\"text-sm font-medium mb-2\">Tipo de resumo</div>\n            <select\n              value={summaryStyle}\n              onChange={(e) => setSummaryStyle(e.target.value as SummaryStyle)}\n              className=\"w-full rounded-lg bg-[#0B0B0B] border border-[#1A1A1A] px-3 py-2 text-sm\"\n              disabled={isUploading}\n            >\n              <option value=\"bullet\">Bullet (tópicos)</option>\n              <option value=\"explained\">Explicado</option>\n            </select>\n          </div>\n\n          <div className=\"rounded-xl border border-[#1A1A1A] bg-[#0D0D0D] p-4\">\n            <div className=\"text-sm font-medium mb-2\">Dificuldade dos flashcards</div>\n            <select\n              value={difficulty}\n              onChange={(e) => setDifficulty(e.target.value as Difficulty)}\n              className=\"w-full rounded-lg bg-[#0B0B0B] border border-[#1A1A1A] px-3 py-2 text-sm\"\n              disabled={isUploading}\n            >\n              <option value=\"easy\">Fácil</option>\n              <option value=\"medium\">Média</option>\n              <option value=\"hard\">Difícil</option>\n            </select>\n          </div>\n\n          <div className=\"rounded-xl border border-[#1A1A1A] bg-[#0D0D0D] p-4\">\n            <div className=\"text-sm font-medium mb-2\">Quantidade de flashcards</div>\n            <div className=\"flex items-center gap-3\">\n              <input\n                type=\"range\"\n                min={1}\n                max={30}\n                value={flashcardsCount}\n                onChange={(e) => setFlashcardsCount(Number(e.target.value))}\n                className=\"w-full\"\n                disabled={isUploading}\n              />\n              <div className=\"min-w-[44px] text-center text-sm font-semibold text-[#00FF8B]\">\n                {flashcardsCount}\n              </div>\n            </div>\n            <div className=\"mt-1 text-xs text-gray-500\">\n              (1 a 30 — depois a gente libera mais no PRO)\n            </div>\n          </div>\n        </div>\n\n        {/* dropzone */}\n        <div\n          onDrop={onDrop}\n          onDragOver={onDragOver}\n          className={cn(\n            \"mt-6 rounded-2xl border border-dashed p-8 sm:p-10 text-center transition\",\n            \"border-[#2A2A2A] bg-[#0B0B0B]\",\n            isUploading ? \"opacity-70\" : \"hover:border-[#00FF8B]/40\"\n          )}\n        >\n          <div className=\"mx-auto flex h-12 w-12 items-center justify-center rounded-2xl border border-[#1A1A1A] bg-[#0F0F0F]\">\n            <FileText className=\"h-6 w-6 text-gray-300\" />\n          </div>\n\n          <div className=\"mt-4 text-base sm:text-lg font-semibold\">\n            Arraste e solte seu arquivo aqui\n          </div>\n          <div className=\"mt-2 text-sm text-gray-400\">ou clique para selecionar</div>\n\n          <button\n            onClick={onPickFile}\n            disabled={isUploading}\n            className={cn(\n              \"mt-6 inline-flex items-center justify-center rounded-xl px-5 py-2 text-sm font-medium transition border\",\n              \"border-[#1A1A1A] bg-[#121212] hover:bg-[#161616]\",\n              \"disabled:opacity-60\"\n            )}\n          >\n            {isUploading ? \"Processando...\" : \"Selecionar arquivo\"}\n          </button>\n\n          {fileLabel ? (\n            <div className=\"mt-4 text-xs text-gray-400\">{fileLabel}</div>\n          ) : null}\n\n          {error ? <div className=\"mt-4 text-sm text-red-400\">{error}</div> : null}\n        </div>\n\n        {/* sucesso + ações */}\n        <div className=\"mt-6 flex flex-col sm:flex-row sm:items-center justify-between gap-3\">\n          <div className=\"text-sm text-gray-400\">\n            {success ? (\n              <span className=\"text-[#00FF8B] font-medium\">✅ Concluído! Material gerado.</span>\n            ) : isUploading ? (\n              <span>Gerando… isso pode levar alguns segundos.</span>\n            ) : (\n              <span>Depois de gerar, você pode ir direto para flashcards ou resumo.</span>\n            )}\n          </div>\n\n          <div className=\"flex flex-wrap gap-2\">\n            <button\n              onClick={onGenerateAgain}\n              disabled={!canGenerate}\n              className={cn(\n                \"inline-flex items-center gap-2 rounded-xl px-4 py-2 text-sm font-medium border transition\",\n                \"border-[#1A1A1A] bg-[#121212] hover:bg-[#161616]\",\n                \"disabled:opacity-60\"\n              )}\n              title=\"Gerar novamente com novas opções\"\n            >\n              <RotateCcw className=\"h-4 w-4\" />\n              Gerar novamente\n            </button>\n\n            <button\n              onClick={onGoFlashcards}\n              disabled={!success}\n              className={cn(\n                \"inline-flex items-center gap-2 rounded-xl px-4 py-2 text-sm font-medium transition border\",\n                success\n                  ? \"border-[#00FF8B]/30 bg-[#00FF8B]/10 text-[#00FF8B] hover:bg-[#00FF8B]/15\"\n                  : \"border-[#1A1A1A] bg-[#121212] text-gray-500\",\n                \"disabled:opacity-60\"\n              )}\n            >\n              <BookOpen className=\"h-4 w-4\" />\n              Ir para flashcards\n            </button>\n\n            <button\n              onClick={onGoSummary}\n              disabled={!success}\n              className={cn(\n                \"inline-flex items-center gap-2 rounded-xl px-4 py-2 text-sm font-medium transition border\",\n                success\n                  ? \"border-[#00FF8B]/30 bg-[#00FF8B]/10 text-[#00FF8B] hover:bg-[#00FF8B]/15\"\n                  : \"border-[#1A1A1A] bg-[#121212] text-gray-500\",\n                \"disabled:opacity-60\"\n              )}\n            >\n              <Sparkles className=\"h-4 w-4\" />\n              Ir para resumo\n            </button>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 681, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/lib/studyProgressStore.ts"],"sourcesContent":["\"use client\";\n\n/**\n * Store simples de progresso (localStorage) + \"events\" para atualizar UI.\n * Compatível com:\n * - makeProgressKey\n * - makeProgressKeyForDoc\n * - loadProgress\n * - saveProgress\n * - clearProgress\n * - onProgressUpdated\n */\n\ntype ProgressItem = {\n  knownIds: number[];   // ids marcados como \"sei\"\n  reviewIds: number[];  // ids marcados como \"não sei\"\n  currentIndex: number; // índice atual no deck\n  updatedAt: number;    // timestamp\n};\n\nconst LS_PREFIX = \"studai:progress:v1:\";\n\nfunction safeParse<T>(s: string | null): T | null {\n  if (!s) return null;\n  try {\n    return JSON.parse(s) as T;\n  } catch {\n    return null;\n  }\n}\n\nfunction emit(key: string) {\n  // evento custom local + evento nativo storage\n  window.dispatchEvent(new CustomEvent(\"studai:progress-updated\", { detail: { key } }));\n}\n\nexport function makeProgressKey(userId: string, materialId: string) {\n  return `${LS_PREFIX}${userId}:${materialId}`;\n}\n\n/**\n * Caso seu app trate material como \"docId\" (ou slug/uuid),\n * esse helper mantém compatibilidade com imports antigos.\n */\nexport function makeProgressKeyForDoc(userId: string, docId: string) {\n  return `${LS_PREFIX}${userId}:doc:${docId}`;\n}\n\nexport function loadProgress(key: string): ProgressItem | null {\n  if (typeof window === \"undefined\") return null;\n  return safeParse<ProgressItem>(localStorage.getItem(key));\n}\n\nexport function saveProgress(key: string, progress: ProgressItem) {\n  if (typeof window === \"undefined\") return;\n  localStorage.setItem(\n    key,\n    JSON.stringify({\n      knownIds: Array.from(new Set(progress.knownIds || [])),\n      reviewIds: Array.from(new Set(progress.reviewIds || [])),\n      currentIndex: Number.isFinite(progress.currentIndex) ? progress.currentIndex : 0,\n      updatedAt: Date.now(),\n    } satisfies ProgressItem)\n  );\n  emit(key);\n}\n\nexport function clearProgress(key: string) {\n  if (typeof window === \"undefined\") return;\n  localStorage.removeItem(key);\n  emit(key);\n}\n\n/**\n * Listener para componentes reagirem a mudanças de progresso.\n * Retorna um \"unsubscribe\".\n */\nexport function onProgressUpdated(cb: (key: string) => void) {\n  if (typeof window === \"undefined\") return () => {};\n\n  const handler = (ev: Event) => {\n    const anyEv = ev as any;\n    const key = anyEv?.detail?.key;\n    if (typeof key === \"string\") cb(key);\n  };\n\n  window.addEventListener(\"studai:progress-updated\", handler as any);\n\n  // também escuta mudanças do localStorage (outra aba)\n  const storageHandler = (ev: StorageEvent) => {\n    if (!ev.key) return;\n    if (ev.key.startsWith(LS_PREFIX)) cb(ev.key);\n  };\n  window.addEventListener(\"storage\", storageHandler);\n\n  return () => {\n    window.removeEventListener(\"studai:progress-updated\", handler as any);\n    window.removeEventListener(\"storage\", storageHandler);\n  };\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AAoBA,MAAM,YAAY;AAElB,SAAS,UAAa,CAAgB;IACpC,IAAI,CAAC,GAAG,OAAO;IACf,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,UAAM;QACN,OAAO;IACT;AACF;AAEA,SAAS,KAAK,GAAW;IACvB,8CAA8C;IAC9C,OAAO,aAAa,CAAC,IAAI,YAAY,2BAA2B;QAAE,QAAQ;YAAE;QAAI;IAAE;AACpF;AAEO,SAAS,gBAAgB,MAAc,EAAE,UAAkB;IAChE,OAAO,AAAC,GAAc,OAAZ,WAAsB,OAAV,QAAO,KAAc,OAAX;AAClC;AAMO,SAAS,sBAAsB,MAAc,EAAE,KAAa;IACjE,OAAO,AAAC,GAAc,OAAZ,WAA0B,OAAd,QAAO,SAAa,OAAN;AACtC;AAEO,SAAS,aAAa,GAAW;IACtC;;IACA,OAAO,UAAwB,aAAa,OAAO,CAAC;AACtD;AAEO,SAAS,aAAa,GAAW,EAAE,QAAsB;IAC9D;;IACA,aAAa,OAAO,CAClB,KACA,KAAK,SAAS,CAAC;QACb,UAAU,MAAM,IAAI,CAAC,IAAI,IAAI,SAAS,QAAQ,IAAI,EAAE;QACpD,WAAW,MAAM,IAAI,CAAC,IAAI,IAAI,SAAS,SAAS,IAAI,EAAE;QACtD,cAAc,OAAO,QAAQ,CAAC,SAAS,YAAY,IAAI,SAAS,YAAY,GAAG;QAC/E,WAAW,KAAK,GAAG;IACrB;IAEF,KAAK;AACP;AAEO,SAAS,cAAc,GAAW;IACvC;;IACA,aAAa,UAAU,CAAC;IACxB,KAAK;AACP;AAMO,SAAS,kBAAkB,EAAyB;IACzD;;IAEA,MAAM,UAAU,CAAC;YAEH;QADZ,MAAM,QAAQ;QACd,MAAM,MAAM,kBAAA,6BAAA,gBAAA,MAAO,MAAM,cAAb,oCAAA,cAAe,GAAG;QAC9B,IAAI,OAAO,QAAQ,UAAU,GAAG;IAClC;IAEA,OAAO,gBAAgB,CAAC,2BAA2B;IAEnD,qDAAqD;IACrD,MAAM,iBAAiB,CAAC;QACtB,IAAI,CAAC,GAAG,GAAG,EAAE;QACb,IAAI,GAAG,GAAG,CAAC,UAAU,CAAC,YAAY,GAAG,GAAG,GAAG;IAC7C;IACA,OAAO,gBAAgB,CAAC,WAAW;IAEnC,OAAO;QACL,OAAO,mBAAmB,CAAC,2BAA2B;QACtD,OAAO,mBAAmB,CAAC,WAAW;IACxC;AACF","debugId":null}},
    {"offset": {"line": 765, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/components/FlashcardsSection.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { CheckCircle2, XCircle, ChevronLeft, ChevronRight } from \"lucide-react\";\nimport {\n  loadProgress,\n  saveProgress,\n  makeProgressKey,\n  onProgressUpdated,\n} from \"@/lib/studyProgressStore\";\n\ntype Props = {\n  data?: any | null;\n};\n\ntype Material = {\n  materialId?: string;\n  topic?: string;\n  flashcards?: Array<{ id: number; question: string; answer: string }>;\n  summary?: any;\n};\n\nfunction cn(...s: Array<string | false | null | undefined>) {\n  return s.filter(Boolean).join(\" \");\n}\n\nasync function fetchLatestMaterial(): Promise<Material | null> {\n  const res = await fetch(\"/api/materials/latest\", { method: \"GET\" });\n  const json = await res.json();\n\n  if (!res.ok || !json?.success) return null;\n  const latest = json?.data;\n  if (!latest) return null;\n\n  // latest.data é o Json com topic/flashcards/summary\n  const payload = latest?.data && typeof latest.data === \"object\" ? latest.data : null;\n  if (!payload) return null;\n\n  const material: Material = {\n    ...payload,\n    materialId: latest.id,\n    topic: payload.topic || latest.topic || \"Material\",\n  };\n\n  // salva espelho no localStorage (ajuda quando navegar)\n  try {\n    localStorage.setItem(\"studai:lastMaterialData:v1\", JSON.stringify(material));\n  } catch {}\n\n  return material;\n}\n\nasync function fetchMeId(): Promise<string | null> {\n  try {\n    const res = await fetch(\"/api/auth/me\");\n    const json = await res.json();\n    if (!res.ok || !json?.success) return null;\n    return json?.data?.id || null;\n  } catch {\n    return null;\n  }\n}\n\nexport default function FlashcardsSection({ data }: Props) {\n  const [material, setMaterial] = useState<Material | null>(data || null);\n  const [loading, setLoading] = useState<boolean>(!data);\n  const [error, setError] = useState<string | null>(null);\n\n  const [userId, setUserId] = useState<string | null>(null);\n\n  const [index, setIndex] = useState<number>(0);\n  const [flipped, setFlipped] = useState<boolean>(false);\n  const [knownIds, setKnownIds] = useState<Set<number>>(new Set());\n  const [reviewIds, setReviewIds] = useState<Set<number>>(new Set());\n\n  // 1) pega userId (pra chave do progresso)\n  useEffect(() => {\n    fetchMeId().then(setUserId);\n  }, []);\n\n  // 2) se não veio data por prop, busca do DB\n  useEffect(() => {\n    let alive = true;\n\n    async function load() {\n      if (data) {\n        setMaterial(data);\n        setLoading(false);\n        return;\n      }\n\n      setLoading(true);\n      const latest = await fetchLatestMaterial();\n      if (!alive) return;\n\n      if (!latest) {\n        setError(\"Nenhum material encontrado. Faça um upload primeiro.\");\n        setMaterial(null);\n      } else {\n        setError(null);\n        setMaterial(latest);\n      }\n\n      setLoading(false);\n    }\n\n    load();\n    return () => {\n      alive = false;\n    };\n  }, [data]);\n\n  const cards = useMemo(() => {\n    const list = material?.flashcards || [];\n    return Array.isArray(list) ? list : [];\n  }, [material]);\n\n  const materialId = material?.materialId || \"latest\";\n  const progressKey = useMemo(() => {\n    // se não tiver userId ainda, usa \"me\" pra não quebrar\n    return makeProgressKey(userId || \"me\", materialId);\n  }, [userId, materialId]);\n\n  // 3) carrega progresso quando tiver cards\n  useEffect(() => {\n    if (!cards.length) return;\n\n    const p = loadProgress(progressKey);\n    if (p) {\n      setIndex(Math.min(p.currentIndex || 0, Math.max(0, cards.length - 1)));\n      setKnownIds(new Set(p.knownIds || []));\n      setReviewIds(new Set(p.reviewIds || []));\n    } else {\n      setIndex(0);\n      setKnownIds(new Set());\n      setReviewIds(new Set());\n    }\n\n    // escuta atualizações do progresso\n    const unsub = onProgressUpdated((key) => {\n      if (key !== progressKey) return;\n      const next = loadProgress(progressKey);\n      if (!next) return;\n\n      setIndex(Math.min(next.currentIndex || 0, Math.max(0, cards.length - 1)));\n      setKnownIds(new Set(next.knownIds || []));\n      setReviewIds(new Set(next.reviewIds || []));\n    });\n\n    return () => unsub();\n  }, [cards.length, progressKey]);\n\n  function persist(nextIndex: number, nextKnown: Set<number>, nextReview: Set<number>) {\n    saveProgress(progressKey, {\n      currentIndex: nextIndex,\n      knownIds: Array.from(nextKnown),\n      reviewIds: Array.from(nextReview),\n      updatedAt: Date.now(),\n    });\n  }\n\n  function prev() {\n    const next = Math.max(0, index - 1);\n    setIndex(next);\n    setFlipped(false);\n    persist(next, knownIds, reviewIds);\n  }\n\n  function next() {\n    const next = Math.min(cards.length - 1, index + 1);\n    setIndex(next);\n    setFlipped(false);\n    persist(next, knownIds, reviewIds);\n  }\n\n  function markKnown() {\n    const id = cards[index]?.id;\n    if (!id) return;\n\n    const k = new Set(knownIds);\n    const r = new Set(reviewIds);\n    k.add(id);\n    r.delete(id);\n\n    setKnownIds(k);\n    setReviewIds(r);\n\n    const nextIndex = Math.min(cards.length - 1, index + 1);\n    setIndex(nextIndex);\n    setFlipped(false);\n\n    persist(nextIndex, k, r);\n  }\n\n  function markReview() {\n    const id = cards[index]?.id;\n    if (!id) return;\n\n    const k = new Set(knownIds);\n    const r = new Set(reviewIds);\n    r.add(id);\n    k.delete(id);\n\n    setKnownIds(k);\n    setReviewIds(r);\n\n    const nextIndex = Math.min(cards.length - 1, index + 1);\n    setIndex(nextIndex);\n    setFlipped(false);\n\n    persist(nextIndex, k, r);\n  }\n\n  const total = cards.length;\n  const done = knownIds.size + reviewIds.size;\n  const pct = total > 0 ? Math.round((done / total) * 100) : 0;\n\n  if (loading) {\n    return (\n      <section className=\"w-full\">\n        <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-6 text-gray-300\">\n          Carregando flashcards...\n        </div>\n      </section>\n    );\n  }\n\n  if (error) {\n    return (\n      <section className=\"w-full\">\n        <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-6 text-red-300\">\n          {error}\n        </div>\n      </section>\n    );\n  }\n\n  if (!total) {\n    return (\n      <section className=\"w-full\">\n        <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-6 text-gray-300\">\n          Nenhum flashcard encontrado neste material.\n        </div>\n      </section>\n    );\n  }\n\n  const card = cards[index];\n\n  return (\n    <section className=\"w-full\">\n      <div className=\"mb-5 flex flex-col gap-3\">\n        <div className=\"flex items-end justify-between gap-3\">\n          <div>\n            <div className=\"text-2xl font-bold text-white\">FlashCards</div>\n            <div className=\"text-sm text-gray-400\">\n              {material?.topic || \"Material\"} • {done}/{total} estudados\n            </div>\n          </div>\n\n          <div className=\"text-sm text-gray-400\">{pct}%</div>\n        </div>\n\n        {/* Barra de progresso */}\n        <div className=\"h-2 w-full rounded-full bg-[#1A1A1A] overflow-hidden\">\n          <div\n            className=\"h-full bg-[#00FF8B]\"\n            style={{ width: `${pct}%` }}\n          />\n        </div>\n\n        {/* Contadores */}\n        <div className=\"grid grid-cols-2 gap-3\">\n          <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-4\">\n            <div className=\"text-xs text-gray-400\">Conhecidos</div>\n            <div className=\"text-2xl font-semibold text-white\">{knownIds.size}</div>\n          </div>\n          <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-4\">\n            <div className=\"text-xs text-gray-400\">Para revisar</div>\n            <div className=\"text-2xl font-semibold text-white\">{reviewIds.size}</div>\n          </div>\n        </div>\n      </div>\n\n      {/* Card (flip) */}\n      <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-5\">\n        <div className=\"mb-4 flex items-center justify-between text-sm text-gray-400\">\n          <span>\n            Pergunta {index + 1}/{total}\n          </span>\n          <button\n            onClick={() => setFlipped((v) => !v)}\n            className=\"rounded-lg border border-[#1A1A1A] px-3 py-1 hover:bg-[#1A1A1A]\"\n          >\n            {flipped ? \"Ver pergunta\" : \"Ver resposta\"}\n          </button>\n        </div>\n\n        <div\n          className=\"relative w-full\"\n          style={{ perspective: 1200 }}\n        >\n          <button\n            type=\"button\"\n            onClick={() => setFlipped((v) => !v)}\n            className=\"w-full text-left\"\n            aria-label=\"Virar flashcard\"\n          >\n            <div\n              className={cn(\n                \"relative w-full rounded-2xl border border-[#00FF8B]/25 bg-[#0D0D0D] p-6 transition-transform duration-500\",\n                \"shadow-[0_0_0_1px_rgba(0,255,139,0.08)]\",\n              )}\n              style={{\n                transformStyle: \"preserve-3d\",\n                transform: flipped ? \"rotateY(180deg)\" : \"rotateY(0deg)\",\n                minHeight: 220,\n              }}\n            >\n              {/* Frente */}\n              <div\n                className=\"absolute inset-0 p-6\"\n                style={{ backfaceVisibility: \"hidden\" }}\n              >\n                <div className=\"text-xs text-[#00FF8B] font-semibold\">PERGUNTA</div>\n                <div className=\"mt-3 text-lg sm:text-xl font-semibold text-white\">\n                  {card?.question}\n                </div>\n                <div className=\"mt-6 text-sm text-gray-400\">\n                  Clique no card para virar.\n                </div>\n              </div>\n\n              {/* Verso */}\n              <div\n                className=\"absolute inset-0 p-6\"\n                style={{\n                  backfaceVisibility: \"hidden\",\n                  transform: \"rotateY(180deg)\",\n                }}\n              >\n                <div className=\"text-xs text-[#00FF8B] font-semibold\">RESPOSTA</div>\n                <div className=\"mt-3 text-base sm:text-lg text-gray-100 whitespace-pre-wrap\">\n                  {card?.answer}\n                </div>\n                <div className=\"mt-6 text-sm text-gray-400\">\n                  Clique no card para voltar.\n                </div>\n              </div>\n            </div>\n          </button>\n        </div>\n\n        {/* Ações */}\n        <div className=\"mt-5 flex flex-col sm:flex-row items-center justify-between gap-3\">\n          <button\n            onClick={prev}\n            disabled={index === 0}\n            className=\"w-full sm:w-auto inline-flex items-center justify-center gap-2 rounded-xl border border-[#1A1A1A] px-4 py-2 text-sm text-gray-300 disabled:opacity-40 hover:bg-[#1A1A1A]\"\n          >\n            <ChevronLeft className=\"w-4 h-4\" />\n            Anterior\n          </button>\n\n          <div className=\"flex w-full sm:w-auto gap-2\">\n            <button\n              onClick={markReview}\n              className=\"flex-1 sm:flex-none inline-flex items-center justify-center gap-2 rounded-xl bg-red-600/15 border border-red-500/30 px-4 py-2 text-sm font-semibold text-red-200 hover:bg-red-600/20\"\n            >\n              <XCircle className=\"w-4 h-4\" />\n              Não sei\n            </button>\n\n            <button\n              onClick={markKnown}\n              className=\"flex-1 sm:flex-none inline-flex items-center justify-center gap-2 rounded-xl bg-[#00FF8B] px-4 py-2 text-sm font-semibold text-[#0D0D0D] hover:opacity-90\"\n            >\n              <CheckCircle2 className=\"w-4 h-4\" />\n              Sei\n            </button>\n          </div>\n\n          <button\n            onClick={next}\n            disabled={index >= total - 1}\n            className=\"w-full sm:w-auto inline-flex items-center justify-center gap-2 rounded-xl border border-[#1A1A1A] px-4 py-2 text-sm text-gray-300 disabled:opacity-40 hover:bg-[#1A1A1A]\"\n          >\n            Próximo\n            <ChevronRight className=\"w-4 h-4\" />\n          </button>\n        </div>\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1422, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/components/SummarySection.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { Sparkles } from \"lucide-react\";\n\ntype Props = {\n  data?: any | null;\n};\n\ntype Material = {\n  materialId?: string;\n  topic?: string;\n  flashcards?: any[];\n  summary?: {\n    title?: string;\n    mainTopics?: Array<{ id: number; title: string; content: string; icon?: string }>;\n    keyPoints?: string[];\n    style?: \"bullet\" | \"explained\";\n  };\n};\n\nfunction cn(...s: Array<string | false | null | undefined>) {\n  return s.filter(Boolean).join(\" \");\n}\n\nasync function fetchLatestMaterial(): Promise<Material | null> {\n  const res = await fetch(\"/api/materials/latest\", { method: \"GET\" });\n  const json = await res.json();\n\n  if (!res.ok || !json?.success) return null;\n  const latest = json?.data;\n  if (!latest) return null;\n\n  const payload = latest?.data && typeof latest.data === \"object\" ? latest.data : null;\n  if (!payload) return null;\n\n  const material: Material = {\n    ...payload,\n    materialId: latest.id,\n    topic: payload.topic || latest.topic || \"Material\",\n  };\n\n  try {\n    localStorage.setItem(\"studai:lastMaterialData:v1\", JSON.stringify(material));\n  } catch {}\n\n  return material;\n}\n\nexport default function SummarySection({ data }: Props) {\n  const [material, setMaterial] = useState<Material | null>(data || null);\n  const [loading, setLoading] = useState<boolean>(!data);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    let alive = true;\n\n    async function load() {\n      if (data) {\n        setMaterial(data);\n        setLoading(false);\n        return;\n      }\n\n      setLoading(true);\n      const latest = await fetchLatestMaterial();\n      if (!alive) return;\n\n      if (!latest) {\n        setError(\"Nenhum material encontrado. Faça um upload primeiro.\");\n        setMaterial(null);\n      } else {\n        setError(null);\n        setMaterial(latest);\n      }\n\n      setLoading(false);\n    }\n\n    load();\n    return () => {\n      alive = false;\n    };\n  }, [data]);\n\n  const summary = material?.summary || null;\n\n  const title = useMemo(() => {\n    if (summary?.title) return summary.title;\n    if (material?.topic) return `${material.topic} - Resumo`;\n    return \"Resumo\";\n  }, [summary?.title, material?.topic]);\n\n  const mainTopics = useMemo(() => {\n    const list = summary?.mainTopics || [];\n    return Array.isArray(list) ? list : [];\n  }, [summary?.mainTopics]);\n\n  const keyPoints = useMemo(() => {\n    const list = summary?.keyPoints || [];\n    return Array.isArray(list) ? list : [];\n  }, [summary?.keyPoints]);\n\n  if (loading) {\n    return (\n      <section className=\"w-full\">\n        <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-6 text-gray-300\">\n          Carregando resumo...\n        </div>\n      </section>\n    );\n  }\n\n  if (error) {\n    return (\n      <section className=\"w-full\">\n        <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-6 text-red-300\">\n          {error}\n        </div>\n      </section>\n    );\n  }\n\n  if (!summary) {\n    return (\n      <section className=\"w-full\">\n        <div className=\"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-6 text-gray-300\">\n          Nenhum resumo encontrado neste material.\n        </div>\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"w-full\">\n      <div className=\"mb-6 flex items-start justify-between gap-3\">\n        <div>\n          <div className=\"inline-flex items-center gap-2 rounded-full border border-[#00FF8B]/25 bg-[#00FF8B]/10 px-3 py-1 text-xs font-semibold text-[#00FF8B]\">\n            <Sparkles className=\"w-4 h-4\" />\n            Gerado por IA\n          </div>\n\n          <h2 className=\"mt-3 text-2xl sm:text-3xl font-bold text-white\">\n            {title}\n          </h2>\n\n          {material?.materialId ? (\n            <div className=\"mt-2 text-[11px] text-gray-500 break-all\">\n              materialId: <span className=\"font-mono\">{material.materialId}</span>\n            </div>\n          ) : null}\n        </div>\n      </div>\n\n      {/* Main topics */}\n      <div className=\"space-y-4\">\n        {mainTopics.map((t) => (\n          <div\n            key={t.id}\n            className={cn(\n              \"rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-5\",\n              \"shadow-[0_0_0_1px_rgba(0,255,139,0.06)]\"\n            )}\n          >\n            <div className=\"flex items-start gap-3\">\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-xl bg-[#00FF8B]/10 border border-[#00FF8B]/15\">\n                <span className=\"text-lg\">{t.icon || \"📌\"}</span>\n              </div>\n\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"text-xs font-semibold text-[#00FF8B]\">\n                  TÓPICO {t.id}\n                </div>\n                <div className=\"mt-1 text-lg font-semibold text-white\">\n                  {t.title}\n                </div>\n                <div className=\"mt-2 text-sm text-gray-200 whitespace-pre-wrap leading-relaxed\">\n                  {t.content}\n                </div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Key points */}\n      {keyPoints.length ? (\n        <div className=\"mt-6 rounded-2xl border border-[#1A1A1A] bg-[#0D0D0D] p-5\">\n          <div className=\"text-sm font-semibold text-white mb-3\">Pontos-chave</div>\n          <ul className=\"space-y-2\">\n            {keyPoints.map((k, i) => (\n              <li key={i} className=\"text-sm text-gray-200 flex gap-2\">\n                <span className=\"text-[#00FF8B]\">•</span>\n                <span className=\"whitespace-pre-wrap\">{k}</span>\n              </li>\n            ))}\n          </ul>\n        </div>\n      ) : null}\n    </section>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1778, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/components/ProgressSection.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { loadMaterial, onMaterialUpdated } from \"@/lib/studyMaterialStore\";\nimport { makeProgressKey, loadProgress, onProgressUpdated, clearProgress } from \"@/lib/studyProgressStore\";\n\nfunction cn(...s: Array<string | false | null | undefined>) {\n  return s.filter(Boolean).join(\" \");\n}\nfunction pct(n: number) {\n  return Math.max(0, Math.min(100, Math.round(n)));\n}\nfunction uniq(arr: number[]) {\n  return Array.from(new Set(arr));\n}\n\nexport default function ProgressSection() {\n  const [topic, setTopic] = useState<string>(\"\");\n  const [totalCards, setTotalCards] = useState<number>(0);\n  const [progressKey, setProgressKey] = useState<string>(\"\");\n\n  const [knownIds, setKnownIds] = useState<number[]>([]);\n  const [reviewIds, setReviewIds] = useState<number[]>([]);\n  const [updatedAt, setUpdatedAt] = useState<string | null>(null);\n\n  useEffect(() => {\n    const refresh = () => {\n      const m = loadMaterial();\n      const count = m?.flashcards?.length ?? 0;\n\n      setTopic(m?.topic ?? \"\");\n      setTotalCards(count);\n\n      const key = makeProgressKey(m?.topic ?? \"deck\", count);\n      setProgressKey(key);\n\n      const p = loadProgress(key);\n      setKnownIds(p?.knownIds ?? []);\n      setReviewIds(p?.reviewIds ?? []);\n      setUpdatedAt(p?.updatedAt ?? null);\n    };\n\n    refresh();\n    const off1 = onMaterialUpdated(refresh);\n    const off2 = onProgressUpdated(refresh);\n    return () => {\n      off1?.();\n      off2?.();\n    };\n  }, []);\n\n  const known = useMemo(() => new Set(knownIds), [knownIds]);\n  const review = useMemo(() => new Set(reviewIds), [reviewIds]);\n\n  const doneCount = uniq([...knownIds, ...reviewIds]).length;\n  const donePct = totalCards ? pct((doneCount / totalCards) * 100) : 0;\n\n  const knownCount = known.size;\n  const reviewCount = review.size;\n  const remainingCount = Math.max(0, totalCards - doneCount);\n\n  if (!totalCards) {\n    return (\n      <section className=\"w-full max-w-5xl mx-auto mt-10 rounded-2xl border border-white/10 bg-white/5 p-8 text-center\">\n        <h2 className=\"text-2xl font-semibold\">Progresso</h2>\n        <p className=\"mt-2 opacity-70\">Gere um material (upload) para acompanhar seu progresso.</p>\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"w-full max-w-5xl mx-auto mt-10\">\n      {/* Header premium */}\n      <div className=\"rounded-2xl border border-white/10 bg-white/5 p-6\">\n        <div className=\"flex flex-col md:flex-row md:items-start md:justify-between gap-4\">\n          <div>\n            <div className=\"text-xs opacity-70\">Progresso</div>\n            <h2 className=\"text-2xl font-semibold mt-1\">{topic || \"Seu deck\"}</h2>\n            <div className=\"mt-2 text-sm opacity-70\">\n              Acompanhe seu avanço no mesmo padrão visual do Flashcards.\n            </div>\n          </div>\n\n          <div className=\"flex flex-wrap gap-2\">\n            <Chip tone=\"green\" label={`✅ Conhecidos: ${knownCount}`} />\n            <Chip tone=\"red\" label={`❌ Revisar: ${reviewCount}`} />\n            <Chip tone=\"neutral\" label={`⏳ Restantes: ${remainingCount}`} />\n          </div>\n        </div>\n\n        {/* Progress bar */}\n        <div className=\"mt-5\">\n          <div className=\"flex items-center justify-between text-xs opacity-70\">\n            <span>Progresso geral</span>\n            <span>{donePct}%</span>\n          </div>\n          <div className=\"mt-2 h-2 w-full rounded-full bg-black/30 overflow-hidden border border-white/10\">\n            <div className=\"h-full rounded-full bg-[#00FF8B]/70\" style={{ width: `${donePct}%` }} />\n          </div>\n\n          <div className=\"mt-3 text-xs opacity-60\">\n            {updatedAt ? `Última atualização: ${new Date(updatedAt).toLocaleString()}` : \"Ainda sem atualizações\"}\n          </div>\n        </div>\n\n        {/* Action row */}\n        <div className=\"mt-5 flex flex-col sm:flex-row items-center justify-between gap-3\">\n          <div className=\"text-sm opacity-70\">\n            Total de cards: <b className=\"opacity-90\">{totalCards}</b> • Concluídos:{\" \"}\n            <b className=\"opacity-90\">{doneCount}</b>\n          </div>\n\n          <button\n            onClick={() => {\n              if (!progressKey) return;\n              clearProgress(progressKey);\n            }}\n            className=\"rounded-2xl border border-white/10 bg-white/5 px-5 py-3 text-sm hover:bg-white/10\"\n          >\n            Limpar progresso deste deck\n          </button>\n        </div>\n      </div>\n\n      {/* Breakdown premium */}\n      <div className=\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <StatCard title=\"Conhecidos\" value={knownCount} subtitle=\"Você marcou como acertei\" tone=\"green\" />\n        <StatCard title=\"Revisar\" value={reviewCount} subtitle=\"Precisa reforçar\" tone=\"red\" />\n        <StatCard title=\"Restantes\" value={remainingCount} subtitle=\"Ainda não avaliados\" tone=\"neutral\" />\n      </div>\n\n      {/* Dica */}\n      <div className=\"mt-6 rounded-2xl border border-white/10 bg-white/5 p-6\">\n        <div className=\"font-semibold\">Dica de estudo</div>\n        <p className=\"mt-2 opacity-70 leading-relaxed\">\n          Use sessões curtas (10–20 cards) e marque “Revisar” sem medo. O ideal é voltar nesses cards no dia seguinte.\n        </p>\n      </div>\n    </section>\n  );\n}\n\nfunction Chip({ label, tone }: { label: string; tone: \"green\" | \"red\" | \"neutral\" }) {\n  const cls =\n    tone === \"green\"\n      ? \"border-[#00FF8B]/25 bg-[#00FF8B]/10 text-[#00FF8B]\"\n      : tone === \"red\"\n      ? \"border-red-500/25 bg-red-500/10 text-red-200\"\n      : \"border-white/10 bg-black/20 text-white/70\";\n  return <span className={cn(\"text-xs px-3 py-1 rounded-full border\", cls)}>{label}</span>;\n}\n\nfunction StatCard({\n  title,\n  value,\n  subtitle,\n  tone,\n}: {\n  title: string;\n  value: number;\n  subtitle: string;\n  tone: \"green\" | \"red\" | \"neutral\";\n}) {\n  const border =\n    tone === \"green\"\n      ? \"border-[#00FF8B]/20\"\n      : tone === \"red\"\n      ? \"border-red-500/20\"\n      : \"border-white/10\";\n\n  const bg =\n    tone === \"green\"\n      ? \"bg-[#00FF8B]/10\"\n      : tone === \"red\"\n      ? \"bg-red-500/10\"\n      : \"bg-black/20\";\n\n  const text =\n    tone === \"green\" ? \"text-[#00FF8B]\" : tone === \"red\" ? \"text-red-200\" : \"text-white/80\";\n\n  return (\n    <div className={cn(\"rounded-2xl border bg-white/5 p-6\", border)}>\n      <div className=\"text-xs opacity-70\">{title}</div>\n      <div className={cn(\"mt-2 text-3xl font-bold\", text)}>{value}</div>\n      <div className={cn(\"mt-3 rounded-xl border p-3 text-sm opacity-90\", border, bg)}>{subtitle}</div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;AAJA;;;;AAMA,SAAS;IAAG,IAAA,IAAA,OAAA,UAAA,QAAA,AAAG,IAAH,UAAA,OAAA,OAAA,GAAA,OAAA,MAAA;QAAG,EAAH,QAAA,SAAA,CAAA,KAA8C;;IACxD,OAAO,EAAE,MAAM,CAAC,SAAS,IAAI,CAAC;AAChC;AACA,SAAS,IAAI,CAAS;IACpB,OAAO,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,KAAK,KAAK,KAAK,CAAC;AAC9C;AACA,SAAS,KAAK,GAAa;IACzB,OAAO,MAAM,IAAI,CAAC,IAAI,IAAI;AAC5B;AAEe,SAAS;;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IACrD,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IAEvD,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACrD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACvD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAE1D,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;qCAAE;YACR,MAAM;qDAAU;wBAEA;oBADd,MAAM,IAAI,CAAA,GAAA,mIAAA,CAAA,eAAY,AAAD;wBACP;oBAAd,MAAM,QAAQ,CAAA,uBAAA,cAAA,yBAAA,gBAAA,EAAG,UAAU,cAAb,oCAAA,cAAe,MAAM,cAArB,kCAAA,uBAAyB;wBAE9B;oBAAT,SAAS,CAAA,WAAA,cAAA,wBAAA,EAAG,KAAK,cAAR,sBAAA,WAAY;oBACrB,cAAc;wBAEc;oBAA5B,MAAM,MAAM,CAAA,GAAA,mIAAA,CAAA,kBAAe,AAAD,EAAE,CAAA,YAAA,cAAA,wBAAA,EAAG,KAAK,cAAR,uBAAA,YAAY,QAAQ;oBAChD,eAAe;oBAEf,MAAM,IAAI,CAAA,GAAA,mIAAA,CAAA,eAAY,AAAD,EAAE;wBACX;oBAAZ,YAAY,CAAA,cAAA,cAAA,wBAAA,EAAG,QAAQ,cAAX,yBAAA,cAAe,EAAE;wBAChB;oBAAb,aAAa,CAAA,eAAA,cAAA,wBAAA,EAAG,SAAS,cAAZ,0BAAA,eAAgB,EAAE;wBAClB;oBAAb,aAAa,CAAA,eAAA,cAAA,wBAAA,EAAG,SAAS,cAAZ,0BAAA,eAAgB;gBAC/B;;YAEA;YACA,MAAM,OAAO,CAAA,GAAA,mIAAA,CAAA,oBAAiB,AAAD,EAAE;YAC/B,MAAM,OAAO,CAAA,GAAA,mIAAA,CAAA,oBAAiB,AAAD,EAAE;YAC/B;6CAAO;oBACL,iBAAA,2BAAA;oBACA,iBAAA,2BAAA;gBACF;;QACF;oCAAG,EAAE;IAEL,MAAM,QAAQ,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD;0CAAE,IAAM,IAAI,IAAI;yCAAW;QAAC;KAAS;IACzD,MAAM,SAAS,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD;2CAAE,IAAM,IAAI,IAAI;0CAAY;QAAC;KAAU;IAE5D,MAAM,YAAY,KAAK;WAAI;WAAa;KAAU,EAAE,MAAM;IAC1D,MAAM,UAAU,aAAa,IAAI,AAAC,YAAY,aAAc,OAAO;IAEnE,MAAM,aAAa,MAAM,IAAI;IAC7B,MAAM,cAAc,OAAO,IAAI;IAC/B,MAAM,iBAAiB,KAAK,GAAG,CAAC,GAAG,aAAa;IAEhD,IAAI,CAAC,YAAY;QACf,qBACE,6LAAC;YAAQ,WAAU;;8BACjB,6LAAC;oBAAG,WAAU;8BAAyB;;;;;;8BACvC,6LAAC;oBAAE,WAAU;8BAAkB;;;;;;;;;;;;IAGrC;IAEA,qBACE,6LAAC;QAAQ,WAAU;;0BAEjB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;;kDACC,6LAAC;wCAAI,WAAU;kDAAqB;;;;;;kDACpC,6LAAC;wCAAG,WAAU;kDAA+B,SAAS;;;;;;kDACtD,6LAAC;wCAAI,WAAU;kDAA0B;;;;;;;;;;;;0CAK3C,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAK,MAAK;wCAAQ,OAAO,AAAC,iBAA2B,OAAX;;;;;;kDAC3C,6LAAC;wCAAK,MAAK;wCAAM,OAAO,AAAC,cAAyB,OAAZ;;;;;;kDACtC,6LAAC;wCAAK,MAAK;wCAAU,OAAO,AAAC,gBAA8B,OAAf;;;;;;;;;;;;;;;;;;kCAKhD,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;kDAAK;;;;;;kDACN,6LAAC;;4CAAM;4CAAQ;;;;;;;;;;;;;0CAEjB,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;oCAAsC,OAAO;wCAAE,OAAO,AAAC,GAAU,OAAR,SAAQ;oCAAG;;;;;;;;;;;0CAGrF,6LAAC;gCAAI,WAAU;0CACZ,YAAY,AAAC,uBAA2D,OAArC,IAAI,KAAK,WAAW,cAAc,MAAO;;;;;;;;;;;;kCAKjF,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;oCAAqB;kDAClB,6LAAC;wCAAE,WAAU;kDAAc;;;;;;oCAAe;oCAAe;kDACzE,6LAAC;wCAAE,WAAU;kDAAc;;;;;;;;;;;;0CAG7B,6LAAC;gCACC,SAAS;oCACP,IAAI,CAAC,aAAa;oCAClB,CAAA,GAAA,mIAAA,CAAA,gBAAa,AAAD,EAAE;gCAChB;gCACA,WAAU;0CACX;;;;;;;;;;;;;;;;;;0BAOL,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAS,OAAM;wBAAa,OAAO;wBAAY,UAAS;wBAA2B,MAAK;;;;;;kCACzF,6LAAC;wBAAS,OAAM;wBAAU,OAAO;wBAAa,UAAS;wBAAmB,MAAK;;;;;;kCAC/E,6LAAC;wBAAS,OAAM;wBAAY,OAAO;wBAAgB,UAAS;wBAAsB,MAAK;;;;;;;;;;;;0BAIzF,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCAAgB;;;;;;kCAC/B,6LAAC;wBAAE,WAAU;kCAAkC;;;;;;;;;;;;;;;;;;AAMvD;GA5HwB;KAAA;AA8HxB,SAAS,KAAK,KAAqE;QAArE,EAAE,KAAK,EAAE,IAAI,EAAwD,GAArE;IACZ,MAAM,MACJ,SAAS,UACL,uDACA,SAAS,QACT,iDACA;IACN,qBAAO,6LAAC;QAAK,WAAW,GAAG,yCAAyC;kBAAO;;;;;;AAC7E;MARS;AAUT,SAAS,SAAS,KAUjB;QAViB,EAChB,KAAK,EACL,KAAK,EACL,QAAQ,EACR,IAAI,EAML,GAViB;IAWhB,MAAM,SACJ,SAAS,UACL,wBACA,SAAS,QACT,sBACA;IAEN,MAAM,KACJ,SAAS,UACL,oBACA,SAAS,QACT,kBACA;IAEN,MAAM,OACJ,SAAS,UAAU,mBAAmB,SAAS,QAAQ,iBAAiB;IAE1E,qBACE,6LAAC;QAAI,WAAW,GAAG,qCAAqC;;0BACtD,6LAAC;gBAAI,WAAU;0BAAsB;;;;;;0BACrC,6LAAC;gBAAI,WAAW,GAAG,2BAA2B;0BAAQ;;;;;;0BACtD,6LAAC;gBAAI,WAAW,GAAG,iDAAiD,QAAQ;0BAAM;;;;;;;;;;;;AAGxF;MAnCS","debugId":null}},
    {"offset": {"line": 2224, "column": 0}, "map": {"version":3,"sources":["file:///Users/ruangalvao/ProjetosVS/Projetos%20Pessoais/stud.ai-app/app-stud.ai/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { Upload, Sparkles, BookOpen, TrendingUp, Trophy, Users, LogOut } from \"lucide-react\";\nimport UploadSection from \"./components/UploadSection\";\nimport FlashcardsSection from \"./components/FlashcardsSection\";\nimport SummarySection from \"./components/SummarySection\";\nimport ProgressSection from \"./components/ProgressSection\";\nimport { useRouter } from \"next/navigation\";\n\ntype Section = \"upload\" | \"flashcards\" | \"summary\" | \"progress\";\n\nfunction safeParse<T>(s: string | null): T | null {\n  if (!s) return null;\n  try {\n    return JSON.parse(s) as T;\n  } catch {\n    return null;\n  }\n}\n\nexport default function Home() {\n  const router = useRouter();\n\n  const [activeSection, setActiveSection] = useState<Section>(\"upload\");\n  const [studyData, setStudyData] = useState<any>(null);\n\n  // ✅ agora compatível com { success:true, user:{...} }\n  const [me, setMe] = useState<{ id: string; email: string; role?: string; name?: string } | null>(null);\n\n  // carrega último material salvo\n  useEffect(() => {\n    const stored = safeParse<any>(localStorage.getItem(\"studai:lastMaterialData:v1\"));\n    if (stored) setStudyData(stored);\n\n    const storageHandler = (e: StorageEvent) => {\n      if (e.key === \"studai:lastMaterialData:v1\") {\n        const latest = safeParse<any>(e.newValue);\n        setStudyData(latest);\n      }\n    };\n    window.addEventListener(\"storage\", storageHandler);\n    return () => window.removeEventListener(\"storage\", storageHandler);\n  }, []);\n\n  // ✅ pega usuário logado\n  useEffect(() => {\n    let alive = true;\n\n    async function loadMe() {\n      try {\n        const res = await fetch(\"/api/auth/me\", { cache: \"no-store\" });\n        const json = await res.json();\n        if (!alive) return;\n\n        const u = json?.user || json?.data || null; // <- aceita os dois formatos\n        if (res.ok && json?.success && u?.id) setMe(u);\n        else setMe(null);\n      } catch {\n        if (!alive) return;\n        setMe(null);\n      }\n    }\n\n    loadMe();\n    return () => {\n      alive = false;\n    };\n  }, []);\n\n  async function logout() {\n    try {\n      await fetch(\"/api/auth/logout\", { method: \"POST\" });\n    } catch {}\n    setMe(null);\n    router.push(\"/login\");\n  }\n\n  return (\n    <div className=\"min-h-screen bg-[#0D0D0D]\">\n      {/* Header */}\n      <header className=\"border-b border-[#1A1A1A] backdrop-blur-sm bg-[#0D0D0D]/80 sticky top-0 z-50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex items-center justify-between h-16\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-8 h-8 rounded-lg bg-gradient-to-br from-[#00FF8B] to-[#007B5F] flex items-center justify-center\">\n                <Sparkles className=\"w-5 h-5 text-[#0D0D0D]\" />\n              </div>\n              <h1 className=\"text-xl sm:text-2xl font-bold bg-gradient-to-r from-[#00FF8B] to-[#007B5F] bg-clip-text text-transparent\">\n                Stud.ai\n              </h1>\n            </div>\n\n            {/* Desktop Navigation */}\n            <nav className=\"hidden md:flex items-center gap-1\">\n              <NavButton\n                icon={Upload}\n                label=\"Upload\"\n                active={activeSection === \"upload\"}\n                onClick={() => setActiveSection(\"upload\")}\n              />\n              <NavButton\n                icon={BookOpen}\n                label=\"FlashCards\"\n                active={activeSection === \"flashcards\"}\n                onClick={() => setActiveSection(\"flashcards\")}\n              />\n              <NavButton\n                icon={Sparkles}\n                label=\"Resumos\"\n                active={activeSection === \"summary\"}\n                onClick={() => setActiveSection(\"summary\")}\n              />\n              <NavButton\n                icon={TrendingUp}\n                label=\"Progresso\"\n                active={activeSection === \"progress\"}\n                onClick={() => setActiveSection(\"progress\")}\n              />\n            </nav>\n\n            {/* Right side */}\n            <div className=\"flex items-center gap-2\">\n              <div className=\"hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-full bg-[#1A1A1A] border border-[#00FF8B]/20\">\n                <Trophy className=\"w-4 h-4 text-[#00FF8B]\" />\n                <span className=\"text-sm font-medium\">Nível 5</span>\n              </div>\n\n              {/* ✅ Botão Sair */}\n              {me ? (\n                <button\n                  onClick={logout}\n                  className=\"inline-flex items-center gap-2 rounded-xl border border-[#1A1A1A] bg-[#0D0D0D] px-3 py-2 text-sm text-gray-200 hover:bg-[#1A1A1A]\"\n                  title=\"Sair\"\n                >\n                  <LogOut className=\"w-4 h-4 text-[#00FF8B]\" />\n                  <span className=\"hidden sm:inline\">Sair</span>\n                </button>\n              ) : null}\n            </div>\n          </div>\n\n          {/* Mobile Navigation */}\n          <div className=\"md:hidden flex items-center gap-1 pb-3 overflow-x-auto\">\n            <NavButton\n              icon={Upload}\n              label=\"Upload\"\n              active={activeSection === \"upload\"}\n              onClick={() => setActiveSection(\"upload\")}\n              mobile\n            />\n            <NavButton\n              icon={BookOpen}\n              label=\"Cards\"\n              active={activeSection === \"flashcards\"}\n              onClick={() => setActiveSection(\"flashcards\")}\n              mobile\n            />\n            <NavButton\n              icon={Sparkles}\n              label=\"Resumos\"\n              active={activeSection === \"summary\"}\n              onClick={() => setActiveSection(\"summary\")}\n              mobile\n            />\n            <NavButton\n              icon={TrendingUp}\n              label=\"Progresso\"\n              active={activeSection === \"progress\"}\n              onClick={() => setActiveSection(\"progress\")}\n              mobile\n            />\n          </div>\n        </div>\n      </header>\n\n      {/* Main */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\">\n        {activeSection === \"upload\" && (\n          <UploadSection\n            onDataProcessed={setStudyData}\n            onGoFlashcards={() => setActiveSection(\"flashcards\")}\n            onGoSummary={() => setActiveSection(\"summary\")}\n          />\n        )}\n\n        {activeSection === \"flashcards\" && <FlashcardsSection data={studyData} />}\n        {activeSection === \"summary\" && <SummarySection data={studyData} />}\n        {activeSection === \"progress\" && <ProgressSection />}\n      </main>\n\n      {/* Footer */}\n      <footer className=\"border-t border-[#1A1A1A] mt-12 py-8\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex flex-col sm:flex-row items-center justify-between gap-4\">\n            <div className=\"flex items-center gap-2 text-sm text-gray-400\">\n              <Users className=\"w-4 h-4 text-[#00FF8B]\" />\n              <span>+1.2k estudantes ativos hoje</span>\n            </div>\n            <div className=\"text-sm text-gray-500\">Feito com 💚 para estudantes</div>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n\nfunction NavButton({\n  icon: Icon,\n  label,\n  active,\n  onClick,\n  mobile = false,\n}: {\n  icon: any;\n  label: string;\n  active: boolean;\n  onClick: () => void;\n  mobile?: boolean;\n}) {\n  return (\n    <button\n      onClick={onClick}\n      className={`\n        flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-300\n        ${mobile ? \"text-xs whitespace-nowrap\" : \"text-sm\"}\n        ${\n          active\n            ? \"bg-[#00FF8B]/10 text-[#00FF8B] border border-[#00FF8B]/30\"\n            : \"text-gray-400 hover:text-white hover:bg-[#1A1A1A]\"\n        }\n      `}\n    >\n      <Icon className=\"w-4 h-4\" />\n      <span>{label}</span>\n    </button>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}